from hera import create, update, Session, set_database
from hera.schema import TelegramUser


# Stringa fornita
input_string = """
INSERT INTO `user` VALUES (28547460,'SPIKE_HC',18878,1,18880,NULL),(33957909,'Frenkinoo',25091,1,25092,25084),(34140077,'Rudrazzo',22824,1,22825,22817),(35161153,'None',12134,0,12135,NULL),(35277133,'McFlower',9996,0,10002,NULL),(49849355,'Warior_d',21644,1,21650,NULL),(69574262,'hochiminimo',22517,1,22521,NULL),(70107307,'brannhim',27270,1,27271,NULL),(76046519,'None',26263,1,26264,NULL),(87259754,'SSelemaN',13110,0,13111,NULL),(90694338,'Danilo_4',15874,0,15875,NULL),(93389103,'dominoc',14425,0,14426,14418),(100478072,'printfApfs_01',11362,0,11368,NULL),(102956549,'Gianf_99',7134,0,7140,NULL),(105310543,'wincenzo79',9990,0,9991,NULL),(105455437,'wolf333',18500,1,18503,NULL),(108076169,'Arctender',24797,1,24802,NULL),(109221973,'TiJiTiJi',11404,0,11408,NULL),(114848956,'The_Cashew',10185,0,10186,NULL),(115409606,'GianZin',19905,1,19907,NULL),(125434237,'fffulmicotone',11594,0,11600,NULL),(126530809,'r02bi',8048,0,8054,NULL),(130648233,'Niiiitram',14789,0,14795,NULL),(132036134,'BetterWay00',14744,0,14750,NULL),(132833465,'VincenzoZizza',7079,0,7085,NULL),(137771129,'italiaty4',9278,0,9284,NULL),(138893701,'merenwenz',22892,1,22893,22885),(145476901,'s_mart21',12379,0,12385,NULL),(146431482,'aloicl',16256,0,16260,NULL),(147556226,'keewee',24251,1,24257,NULL),(148415212,'None',26295,1,26297,NULL),(152292845,'andy_cappato',21306,1,21312,NULL),(152837271,'Andrewbis87',18504,0,18505,NULL),(157435378,'davidelamz',19463,1,19469,NULL),(157935468,'Dinecl',9538,0,9543,NULL),(158467256,'Punk97',25245,1,25249,NULL),(163540789,'CarpiDev',17605,1,17607,NULL),(165667374,'dammi8',13849,0,13855,NULL),(169130361,'LaurieroAndrea',10297,0,10303,NULL),(171749191,'Elio1',7661,0,7667,NULL),(174557312,'CesareIsHere',9497,0,9503,NULL),(174749772,'Caterina11PP',13106,0,13107,NULL),(175206405,'grandeplay',13681,0,13684,NULL),(175929580,'olotrabed',14483,0,14489,NULL),(176385404,'TheBestCisco01',11045,0,11051,NULL),(177968746,'originalvinorosso',27156,1,27157,NULL),(179740721,'kewil_13',23176,1,23182,NULL),(183350229,'GiuseppeAup',14822,0,14823,14815),(183599787,'Yardrat',9808,0,9809,9801),(187451146,'None',9068,0,9069,NULL),(191500630,'Dany9211',15028,0,15029,NULL),(192720083,'LilPep_02',14834,0,14835,14830),(195383544,'None',23732,1,23738,NULL),(201368256,'SimoAlt',12340,0,12346,NULL),(202063619,'Plasvir',25447,1,25448,NULL),(205352751,'Sadlovell',18390,1,18396,NULL),(206285284,'Paclito',9672,0,9673,9666),(211257255,'CosimoPiscopo',11295,0,11299,NULL),(212670161,'ceres07',26051,1,26053,NULL),(226103193,'giorni_girodasolo',27299,1,27304,NULL),(226285651,'Piero798',13863,0,13864,NULL),(229309914,'kristi1303',10254,0,10260,NULL),(230030293,'valebanco',22614,0,22615,NULL),(230037813,'Shirllpuma',10243,0,10249,NULL),(232973773,'astang',14046,0,14047,14039),(249685639,'VitusD',22428,1,22434,NULL),(252274295,'Frankzafo',12119,0,12125,NULL),(256583193,'None',8301,0,8302,NULL),(259066588,'Kleenecs',8042,0,8043,NULL),(259408532,'er_lattosio',13463,0,13468,NULL),(260261109,'Music_luke',9315,0,9316,NULL),(260576020,'Lizicappa',12280,0,12281,12273),(262010628,'Francesco110299',8250,0,8255,NULL),(276375698,'Coda0',11120,0,11124,NULL),(276450791,'Giac01',12158,0,12163,NULL),(279430983,'BlackSmooh',13911,0,13917,NULL),(279860899,'None',10356,0,10357,10347),(299535169,'francescobevi',12178,0,12181,NULL),(304500077,'liaexx',9726,0,9732,NULL),(316669056,'None',26006,1,26008,NULL),(319527329,'fabiolapalu',26126,1,26131,NULL),(326424671,'Trending3',9202,0,9208,NULL),(326973821,'MaricaMichelaIannone',11633,0,11639,NULL),(331092937,'Ghandar',26325,1,26326,26318),(331625733,'misterseek',14581,0,14587,NULL),(333954146,'pelletx3',9739,0,9745,NULL),(334248271,'Gianno93',13932,0,13938,NULL),(340586253,'chi_yaraa',10105,0,10106,NULL),(341561418,'giamba_elia',22713,1,22719,NULL),(353646128,'None',12235,0,12236,12228),(354740450,'None',9504,0,9505,9487),(369758144,'DanieleC955',11358,0,11359,NULL),(370236805,'buiomega',9388,0,9389,9362),(371312237,'dieg988',21263,1,21264,NULL),(373978689,'giannipantana',9168,0,9174,NULL),(381341773,'MrMitch',25672,1,25678,NULL),(382265655,'peppuxxx',19982,1,19987,NULL),(388991170,'LemonKidd',19304,1,19308,NULL),(389036888,'marghe1199',26101,1,26103,NULL),(389783407,'None',9942,0,9943,NULL),(390979291,'is_hobo',25952,1,25953,NULL),(391575838,'shift97',25982,1,25988,NULL),(397231052,'mmartinarob',14365,0,14371,NULL),(397416509,'Kucigang',26015,1,26016,NULL),(400025222,'ikilluonfortnite',16636,1,16642,NULL),(400687445,'Chris_M0018',10735,0,10739,NULL),(402950413,'shafrangetta',11092,0,11093,NULL),(404567577,'fcechov',26861,1,26866,NULL),(407030187,'LingLingwannabee',23209,1,23215,NULL),(408847007,'cpodd',9548,0,9552,NULL),(408972040,'xVanni24',26981,1,26982,NULL),(409780810,'None',9006,0,9012,NULL),(413829351,'nonlosaichi',13265,0,13271,NULL),(416683050,'None',23411,1,23413,NULL),(421743995,'pierpaolo_bozza',7180,0,7186,NULL),(425467454,'simo_exe22',7328,0,7334,NULL),(434413953,'Dionx97',12319,0,12324,NULL),(436830405,'Giovann0ne',10713,0,10719,NULL),(439281787,'costantino97',11695,0,11701,NULL),(445325384,'kocri',26165,1,26167,NULL),(445479327,'MARCOOZ0',13721,0,13725,NULL),(449897798,'GaetanoCarlone',27307,1,27308,NULL),(450136849,'shikamarunaraa',25387,1,25388,NULL),(452918266,'ntofrume',7944,0,7950,NULL),(454752204,'lucapassaseo',9648,0,9649,NULL),(455401909,'giorgiavillano',25441,1,25442,NULL),(461892294,'marpew',8113,0,8119,NULL),(471909114,'IpIxElL01',10888,0,10894,NULL),(474216475,'FlorenceN',20608,1,20609,20601),(475175632,'AstroPoul',17654,1,17655,NULL),(482106027,'Tannicu',9243,0,9248,NULL),(484197736,'daniele_b12',20206,1,20212,NULL),(487540451,'None',9472,0,9473,NULL),(488754672,'Ergunas',24748,1,24754,NULL),(489572292,'None',16931,1,16932,NULL),(490067415,'lasituazione',9253,0,9259,NULL),(492812379,'None',12492,0,12497,NULL),(497775542,'Cali75cl',12307,0,12308,NULL),(498643028,'pieridevito',22952,1,22958,NULL),(503202842,'damnedsadeyes',15782,0,15788,NULL),(509490972,'None',8402,0,8408,NULL),(510500194,'None',9973,0,9979,NULL),(514274158,'None',9927,0,9928,NULL),(525757314,'username_vane',26591,1,26593,NULL),(526111571,'None',16263,0,16264,NULL),(528140705,'None',8720,0,8726,NULL),(534862815,'None',11733,0,11735,NULL),(536335535,'r3lly',9733,0,9734,NULL),(538381506,'MarcoMrsh',22832,1,22838,NULL),(541278818,'DavideFrrr',10704,0,10708,NULL),(543520686,'hAKIzod',14599,0,14600,14592),(547874162,'animalemagico',7360,0,7366,NULL),(556285839,'AnNa_LiSa94',15140,0,15146,NULL),(557313795,'Nicola_Finocchio',18408,1,18414,NULL),(561146978,'lilliput22',14455,0,14461,NULL),(568560917,'Username0123urgd',8606,0,8612,NULL),(568700009,'None',17199,1,17205,NULL),(569334760,'Sedc9',12207,0,12213,NULL),(578005136,'None',17569,1,17575,NULL),(585290237,'Amancino',9443,0,9449,NULL),(600127464,'Mchel99',25703,1,25705,NULL),(605389519,'None',12718,0,12719,NULL),(606200042,'thanym',26673,1,26674,NULL),(611278422,'flavius111',20396,1,20402,NULL),(611338495,'Nicolasidarous',26151,1,26153,NULL),(613201265,'None',22565,1,22571,NULL),(613682792,'Amazoo01',8516,0,8522,NULL),(614359021,'None',15273,0,15279,NULL),(621036259,'Klaoodia',24220,1,24226,NULL),(621861236,'R9O9bLKSG9',7503,0,7505,NULL),(623303833,'manumil24',10038,0,10044,NULL),(627674844,'Louhw',19383,1,19389,NULL),(629065121,'Piersy_01',9510,0,9516,NULL),(631522910,'JeckDeFeo',26722,1,26723,26715),(631960467,'Rising_force',14470,0,14476,NULL),(633596232,'None',19036,1,19041,NULL),(636294654,'Sinner236',10561,0,10567,NULL),(637832494,'RailiaValchiria',26203,1,26209,NULL),(638995929,'GianniPastafizio',24262,1,24268,NULL),(643599790,'hardG0re',11239,0,11240,11222),(646472127,'Marco212',25882,1,25883,NULL),(649348433,'MrEidz',14387,0,14388,14380),(649505446,'d3v1ld03sntsl33p',15409,0,15415,NULL),(649603468,'None',25172,1,25173,NULL),(653092082,'monheritier',7115,0,7121,NULL),(653876144,'AlessioAllegretta',18955,1,18961,NULL),(654112878,'None',11878,0,11884,NULL),(654980073,'None',25132,1,25134,NULL),(655475482,'kekkoglion3',22301,1,22304,NULL),(661821838,'lacalocoo',7585,0,7591,NULL),(662220933,'exxxexxxe',14634,0,14640,NULL),(663392997,'None',12530,0,12536,NULL),(666523883,'None',11129,0,11135,NULL),(666787994,'nickname0108',13216,0,13222,NULL),(667183092,'Nestore39',10174,0,10175,10137),(672400178,'Asso420',10838,0,10844,NULL),(674833433,'dragoniela',7351,0,7355,NULL),(675518228,'Alex_Rux',19963,1,19969,NULL),(679370214,'Manuel_420',21255,1,21256,NULL),(680707495,'AnthosV',20676,0,20677,NULL),(684729639,'Brrrrrzzzzz123',9042,0,9048,NULL),(688586301,'Rosaaa21',23947,1,23948,NULL),(690848194,'zJohn_z',22574,1,22575,NULL),(696221453,'giusydamb',10265,0,10271,NULL),(709202876,'Mcboff',22504,1,22510,NULL),(713023182,'None',13548,0,13549,NULL),(719168515,'None',18968,1,18974,NULL),(721848150,'yakon98',11760,0,11761,NULL),(736370983,'None',14985,0,14991,NULL),(737945661,'micfas',22526,1,22530,NULL),(740103871,'gio3giaa',10211,0,10212,NULL),(741748644,'davidedefilippis98',16006,0,16012,NULL),(746692617,'M4r1319',7853,0,7859,NULL),(757752931,'exynee',14149,0,14155,NULL),(758358448,'smokey_00',25791,1,25793,NULL),(759706582,'ascletia',16947,1,16948,NULL),(761721119,'Derxax',22989,1,22990,22980),(765067001,'qunderscorep',25569,1,25574,NULL),(776382922,'vitotafuni',12778,0,12784,NULL),(792807926,'None',9148,0,9149,NULL),(792994523,'Don_Grecia',7445,0,7447,NULL),(795104254,'aleciak23',16561,1,16565,NULL),(805626974,'foxest9',20145,1,20146,NULL),(805882403,'MestMcal',14017,0,14023,NULL),(810293535,'zistrafinggg',13977,0,13982,NULL),(810719668,'WhiteGazza',20654,1,20659,NULL),(817597627,'hellalella',12914,0,12920,NULL),(822071403,'mike070298',12521,0,12527,NULL),(829238107,'None',25119,1,25124,NULL),(833977825,'None',11491,0,11497,NULL),(835725172,'RaffaellaR',18248,1,18254,NULL),(836612809,'None',22374,1,22380,NULL),(847109518,'yo_deliahere',7976,0,7977,NULL),(849314316,'Ohgazz',13360,0,13365,NULL),(857261531,'Kntxba',19338,1,19344,NULL),(859071701,'herfsreen',8815,0,8819,NULL),(863219840,'paterelena',12795,0,12796,NULL),(865379915,'Ftioltia',26085,1,26091,NULL),(869056056,'None',13349,0,13355,NULL),(869190514,'Jacopo_thedoc',26819,1,26822,NULL),(875817139,'DavDep',12507,0,12512,NULL),(884598288,'None',21656,0,21657,NULL),(885566243,'MicheleAmoia',27229,1,27231,NULL),(892955348,'None',10910,0,10911,10903),(899648902,'None',9699,0,9705,NULL),(900120603,'nifio_88',27246,1,27248,NULL),(906304004,'None',7316,0,7317,NULL),(909121214,'None',9200,0,9201,9185),(909209127,'None',26250,1,26254,NULL),(916832235,'nicot1na',27144,1,27146,NULL),(919039133,'None',25654,1,25657,NULL),(921151183,'SavinoScomm',14672,0,14678,NULL),(923140148,'None',24362,1,24368,NULL),(923644609,'None',12100,0,12101,NULL),(930972644,'anto31ad',17312,0,17313,NULL),(931862914,'AL3XXX1510',27238,1,27240,NULL),(936305942,'None',9605,0,9611,NULL),(945307252,'None',23353,1,23354,23346),(948276667,'None',15378,0,15384,NULL),(954442569,'marsaf16',7512,0,7516,NULL),(955555704,'Nyx_69',12638,0,12639,12631),(965180018,'rocco_masiello799',8295,0,8298,NULL),(970676064,'thapork',20929,1,20930,20922),(972882199,'GabrielCara',16245,0,16251,NULL),(975369282,'BetoRob',18183,1,18189,NULL),(977204886,'None',14996,0,15002,NULL),(980032201,'absl97',27170,1,27171,NULL),(980363414,'None',11933,0,11935,NULL),(989087667,'ssshh98',25520,1,25526,NULL),(992639091,'None',15603,0,15607,NULL),(995709357,'Vinc1993',24584,1,24585,24577),(995747179,'None',16686,1,16692,NULL),(1001914334,'AltolaIlPudore',26796,1,26798,NULL),(1003778887,'betty_si',9433,0,9438,NULL),(1005445979,'ferr4ri',9313,0,9317,NULL),(1015798904,'Felisia_ws',9958,0,9961,NULL),(1016430616,'Stain23',15569,0,15570,15562),(1017800723,'francesco_dona',12579,0,12585,NULL),(1025836457,'None',9525,0,9531,NULL),(1032428341,'None',27176,1,27177,NULL),(1042534944,'None',9370,0,9371,NULL),(1061473468,'Smartiska',25599,1,25602,NULL),(1066476806,'None',9908,0,9909,NULL),(1070450958,'sabeeeno',13085,0,13090,NULL),(1070725653,'Jeco89',20748,1,20754,NULL),(1074324540,'None',26367,1,26372,NULL),(1082656697,'None',26932,1,26933,NULL),(1088000137,'None',7953,0,7954,NULL),(1100300019,'None',22733,1,22739,NULL),(1103945706,'martaltn',13541,0,13547,NULL),(1107428687,'None',26783,1,26789,NULL),(1123019370,'None',23536,0,23537,NULL),(1131162826,'pyrozbaby',21022,1,21028,NULL),(1137670808,'decubito',27186,1,27189,NULL),(1172209125,'Yegnia',27164,1,27165,NULL),(1183952942,'None',26385,1,26388,NULL),(1208181859,'Lo77777777',25026,1,25032,NULL),(1264215186,'giorgia2511',11826,0,11832,NULL),(1269161720,'ARTIsFEX',26927,1,26931,NULL),(1271098922,'piercedro',12138,0,12139,NULL),(1303228743,'None',13074,0,13080,NULL),(1314387959,'MisakiMei28',26032,1,26033,NULL),(1318349342,'galetta_laura',25737,1,25742,NULL),(1360485978,'BeppeKap',11098,0,11104,NULL),(1386307361,'None',10799,0,10805,NULL),(1400257035,'None',11163,0,11169,NULL),(1455079641,'None',15220,0,15221,15213),(1458653184,'None',9308,0,9313,NULL),(1467318155,'None',14099,0,14105,NULL),(1478812362,'Luigijs',13031,0,13032,13026),(1501438449,'Kholeteral',16804,1,16805,NULL),(1509706644,'None',20321,1,20322,NULL),(1523927134,'None',21242,1,21248,NULL),(1530689451,'None',20931,0,20932,NULL),(1532035344,'Aldannah',10124,0,10128,NULL),(1615253122,'None',17353,1,17359,NULL),(1631598645,'federicamanuto',8335,0,8336,NULL),(1644774326,'None',25422,1,25423,25419),(1654083773,'dakol96',21951,1,21953,NULL),(1683111376,'scr0tat1S',23868,1,23870,NULL),(1710928007,'hunftjmvf',26687,1,26688,NULL),(1733614484,'None',18992,1,18994,NULL),(1738502341,'None',20808,1,20811,NULL),(1744344771,'Zfet90',19127,1,19133,NULL),(1821414872,'Cla_u_96',14700,0,14706,NULL),(1838562504,'None',27140,1,27141,27131),(1925593818,'dee_mood',10287,0,10288,NULL),(1936292700,'Maoooonna',27221,1,27222,NULL),(2005781230,'None',13455,0,13460,NULL),(2016924966,'mero_2211',9186,0,9191,NULL),(2078280357,'too_time',17765,1,17771,NULL),(2090456245,'N0tDaniel',22472,1,22473,NULL),(2147483647,'Nymeria1',26976,0,26980,NULL);"""
# Rimuovi i caratteri non desiderati
cleaned_string = input_string.replace("INSERT INTO `user` VALUES", "").replace("(", "").replace(");", "")

# Divide la stringa in righe separate
lines = cleaned_string.split("),")

# Crea una lista di dizionari
users = []

for line in lines:
    # Rimuovi spazi vuoti e 'NULL' dalla riga
    line = line.replace("NULL", "")
    
    # Divide ogni riga in valori separati da virgole
    values = line.split(",")
    
    # Estrai i valori desiderati
    telegram_id = int(values[0])
    nickname = values[1].strip("'")
    privacy = int(values[3])
    
    # Crea un dizionario per ogni riga e aggiungilo alla lista
    user_dict = {
        "telegram_id": telegram_id,
        "nickname": nickname,
        "privacy": privacy
    }
    
    users.append(user_dict)

def get_user(id):
    with Session() as session:
        return session.query(TelegramUser).filter(TelegramUser.telegram_id == id).first()

set_database('postgresql://istwhnozdurhdf:f998018b33e66fd7557d94a7625f9478b076c407d86e64c5ae34a3eecc13f0a2@ec2-3-248-141-201.eu-west-1.compute.amazonaws.com:5432/dd9s71hbcqktul')
# Stampa la lista di dizionari
for user in users:
    print(user)
    u = get_user(user['telegram_id'])
    if u:
        update(u, {'privacy': user['privacy']})
    else:
        create(TelegramUser, user)